<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prospecting! Calculator</title>
    <style>
        :root {
            --bg-color: #1a160d;
            --card-bg: #12100a;
            --accent-gold: #c5a447;
            --text-main: #dfd3b6;
            --input-bg: #000000;
            --border: #443c28;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Segoe UI', Roboto, sans-serif;
            display: flex;
            justify-content: center;
            padding: 20px;
            margin: 0;
        }

        .calc-container {
            width: 100%;
            max-width: 450px;
            background: var(--card-bg);
            border: 2px solid var(--accent-gold);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        h1 {
            color: var(--accent-gold);
            text-align: center;
            font-size: 26px;
            margin-bottom: 5px;
            text-transform: capitalize;
        }

        .subtitle {
            text-align: center;
            font-style: italic;
            font-size: 13px;
            color: var(--accent-gold);
            opacity: 0.8;
            margin-bottom: 25px;
            border-bottom: 1px solid var(--accent-gold);
            padding-bottom: 15px;
        }

        label {
            display: block;
            color: var(--accent-gold);
            font-size: 15px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        select, input {
            width: 100%;
            background: var(--input-bg);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 12px;
            color: #ffffff;
            font-size: 18px;
            box-sizing: border-box;
            margin-bottom: 20px;
            outline: none;
        }

        input:focus {
            border-color: var(--accent-gold);
        }

        .strategy-box {
            background: rgba(197, 164, 71, 0.05);
            border: 1px dashed var(--accent-gold);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .check-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            color: var(--accent-gold);
            font-size: 14px;
        }

        .check-row input { width: auto; margin: 0; }

        .result-panel {
            background: #000000;
            border: 1px solid var(--accent-gold);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            margin-top: 10px;
        }

        .result-label {
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 13px;
            color: var(--text-main);
            margin-bottom: 10px;
            display: block;
        }

        .main-score {
            font-size: 38px;
            font-weight: bold;
            color: var(--accent-gold);
            display: block;
        }

        .formula-hint {
            font-size: 12px;
            color: var(--accent-gold);
            opacity: 0.6;
            margin-top: 10px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
    </style>
</head>
<body>

<div class="calc-container">
    <h1>Prospecting Formula Calculator</h1>
    <div class="subtitle">Formulas created by Autumn</div>

    <label>Calculation Mode:</label>
    <select id="calcMode" onchange="toggleMode()">
        <option value="quick">Standard Efficiency (R)</option>
        <option value="full">Cookie Buff Strategy</option>
    </select>

    <div id="strategyArea" style="display:none;">
        <div class="strategy-box">
            <label style="font-size:12px; opacity:0.8;">XMAS EQUIPMENT & BUFFS</label>
            <div class="check-row"><input type="radio" name="eq" id="eqNone" checked onchange="calc()"> No Equipment</div>
            <div class="check-row"><input type="radio" name="eq" id="eqShovel" onchange="calc()"> Shovel Only (180s CD)</div>
            <div class="check-row"><input type="radio" name="eq" id="eqBoth" onchange="calc()"> Shovel + Pan (90s CD)</div>
            <div class="check-row" style="border-top: 1px solid var(--border); padding-top:10px; margin-top:5px;">
                <input type="checkbox" id="santaBag" onchange="calc()"> Santa's Bag (60s Duration)
            </div>
        </div>

        <label>Base Stats (Brackets):</label>
        <div class="grid-2">
            <input type="number" id="bL" placeholder="Base L" oninput="calc()">
            <input type="number" id="bC" placeholder="Base C" oninput="calc()">
            <input type="number" id="bSPD" placeholder="Base Spd%" oninput="calc()">
            <input type="number" id="bS" placeholder="Base S" oninput="calc()">
        </div>
    </div>

    <label>Luck (L):</label>
    <input type="number" id="tL" placeholder="Total Luck" oninput="calc()">

    <label>Capacity (C):</label>
    <input type="number" id="tC" placeholder="Total Capacity" oninput="calc()">

    <label>Shake Speed (a):</label>
    <input type="number" id="tSPD" placeholder="Total Speed %" oninput="calc()">

    <label>Shake Strength (s):</label>
    <input type="number" id="tS" placeholder="Total Strength" oninput="calc()">

    <div class="result-panel">
        <span class="result-label" id="scoreType">Shaking Efficiency Score</span>
        <span id="scoreDisplay" class="main-score">0.0</span>
        <div id="subInfo" style="font-size: 12px; margin-top:5px; color: var(--accent-gold);">SPS: 0.000</div>
        <div class="formula-hint">LâˆšC / (Penalty + 2.5)</div>
    </div>
</div>

<script>
    const spsMap = [[0,0], [250,6.031], [300,6.906], [350,6.620], [400,6.793], [450,9.119], [500,9.817], [550,9.940], [600,10.461], [650,10.267], [710,10.027], [760,9.119], [810,11.848], [860,11.943], [909,12.325], [939,12.542], [989,13.979], [1039,14.691], [1069,14.866], [1119,13.953], [1169,11.592], [1199,14.299], [1249,14.720], [1299,14.735], [1329,14.881], [1379,14.451], [1429,12.658], [1509,11.981], [1559,14.606], [1689,14.634], [1731,14.620], [1761,12.853], [1811,15.259], [1861,15.385], [1941,16.146], [1991,16.393], [2121,18.204], [2168,14.313], [2211,19.231], [2355,19.608]];

    function toggleMode() {
        const mode = document.getElementById('calcMode').value;
        document.getElementById('strategyArea').style.display = mode === 'full' ? 'block' : 'none';
        document.getElementById('scoreType').innerText = mode === 'full' ? 'Weighted Avg Efficiency' : 'Shaking Efficiency Score';
        calc();
    }

    function getSPS(spd) {
        if (spd <= 0) return 0;
        if (spd >= 2355) return 19.608;
        for (let i = 0; i < spsMap.length - 1; i++) {
            if (spd >= spsMap[i][0] && spd <= spsMap[i+1][0]) {
                return spsMap[i][1] + (spd - spsMap[i][0]) * (spsMap[i+1][1] - spsMap[i][1]) / (spsMap[i+1][0] - spsMap[i][0]);
            }
        } return 0;
    }

    function solve(l, c, r, s) {
        if (l<=0 || c<=0 || r<=0 || s<=0) return 0;
        return (l * Math.sqrt(c)) / (c / (r * s) + 2.5);
    }

    function calc() {
        const L = parseFloat(document.getElementById('tL').value) || 0;
        const C = parseFloat(document.getElementById('tC').value) || 0;
        const SPD = parseFloat(document.getElementById('tSPD').value) || 0;
        const S = parseFloat(document.getElementById('tS').value) || 0;
        
        const mode = document.getElementById('calcMode').value;
        const r_low = getSPS(SPD);
        const score_low = solve(L, C, r_low, S);

        if (mode === 'quick') {
            document.getElementById('scoreDisplay').innerText = score_low.toLocaleString(undefined, {minimumFractionDigits: 1, maximumFractionDigits: 1});
            document.getElementById('subInfo').innerText = `SPS: ${r_low.toFixed(3)}`;
            return;
        }

        const bL = parseFloat(document.getElementById('bL').value) || 0;
        const bC = parseFloat(document.getElementById('bC').value) || 0;
        const bSPD = parseFloat(document.getElementById('bSPD').value) || 0;
        const bS = parseFloat(document.getElementById('bS').value) || 0;

        const pL = L + bL; const pC = C + bC; const pSPD = SPD + bSPD; const pS = S + bS;
        const r_high = getSPS(pSPD);
        const score_high = solve(pL, pC, r_high, pS);

        const hasBoth = document.getElementById('eqBoth').checked;
        const hasShovel = document.getElementById('eqShovel').checked || hasBoth;
        const hasBag = document.getElementById('santaBag').checked;

        if (!hasShovel) {
            document.getElementById('scoreDisplay').innerText = score_low.toLocaleString(undefined, {minimumFractionDigits: 1, maximumFractionDigits: 1});
            document.getElementById('subInfo').innerText = "Requires Shovel for Buff";
            return;
        }

        const dur = hasBag ? 60 : 30;
        const cd = (hasBoth ? 90 : 180) + 20; // +20 trigger time
        const avg = (score_high * dur + score_low * cd) / (dur + cd);

        document.getElementById('scoreDisplay').innerText = avg.toLocaleString(undefined, {minimumFractionDigits: 1, maximumFractionDigits: 1});
        document.getElementById('subInfo').innerText = `Peak: ${Math.round(score_high).toLocaleString()} | Buff SPS: ${r_high.toFixed(3)}`;
    }
</script>

</body>
</html>
